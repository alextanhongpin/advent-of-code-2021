// You can edit this code!
// Click here and start typing.
package main

import (
	"fmt"
	"sort"
	"strings"
)

func main() {
	fmt.Println("part 1", part1(example)) // 48
	fmt.Println("part 1", part1(input))   // 582
}

func copymap(m map[point]bool) map[point]bool {
	res := make(map[point]bool)
	for k, v := range m {
		res[k] = v
	}
	return res
}

func part1(input string) int {
	east, south, paths, max := parse(input)

	update := func(m map[point]bool, modifier func(p *point)) (map[point]bool, int) {
		var points []point
		for p := range m {
			points = append(points, p)
		}
		sort.Slice(points, func(i, j int) bool {
			if points[i].y != points[j].y {
				return points[i].y < points[j].y
			}
			return points[i].x < points[j].x
		})
		newm := copymap(m)
		count := 0
		for _, c := range points {
			p := c
			modifier(&p)
			if east[p] || south[p] {
				continue
			}
			delete(newm, c)
			newm[p] = true
			count++
		}
		return newm, count
	}

	move := func() bool {
		var eastcount int
		east, eastcount = update(east, func(p *point) {
			p.x++
			if !paths[*p] {
				p.x = 0
			}
		})
		var southcount int
		south, southcount = update(south, func(p *point) {
			p.y++
			if !paths[*p] {
				p.y = 0
			}
		})
		return (eastcount + southcount) > 0
	}

	var rounds int
	for {
		rounds++
		if !move() {
			draw(east, south, max)
			return rounds
		}
	}
}

func draw(east, south map[point]bool, max point) {
	for y := 0; y <= max.y; y++ {
		for x := 0; x <= max.x; x++ {
			p := point{x, y}
			if east[p] {
				fmt.Print(">")
			} else if south[p] {
				fmt.Print("v")
			} else {
				fmt.Print(".")
			}
		}
		fmt.Println()
	}
	fmt.Println()
}

func parse(input string) (map[point]bool, map[point]bool, map[point]bool, point) {
	input = strings.TrimSpace(input)
	lines := strings.Split(input, "\n")
	east, south := make(map[point]bool), make(map[point]bool)
	paths := make(map[point]bool)
	max := point{}
	for y, line := range lines {
		if y > max.y {
			max.y = y
		}
		for x, row := range line {
			p := point{x, y}
			switch row {
			case 'v':
				south[p] = true
			case '>':
				east[p] = true
			}
			paths[p] = true

			if x > max.x {
				max.x = x
			}
		}
	}
	return east, south, paths, max
}

type point struct {
	x, y int
}

func (p point) String() string {
	return fmt.Sprintf("<%d,%d>", p.x, p.y)
}

var example = `v...>>.vv>
.vv>>.vv..
>>.>v>...v
>>v>>.>.v.
v>v.vv.v..
>.>>..v...
.vv..>.>v.
v.v..>>v.v
....v..v.>`
var input = `>v.v>...>v>.>>v>.>..>.v.v..v>v..v>.v.>.v.vv.v>...v.vv>v.>v>v>.v>v.>..v.v..v..>..>vv.>v.v...vv.vvvv>v.vv.>v....>.>..v>.v>.>v>v.>>>v......v.>
..>vvvv....v...>>>>.v.>.v>.v>v.>.....>>v.>....v>..v..v.v.v.v.>v>.vvvv.>.v..>>v.>>>.>.>..>v.v...>>.>.>.v>.>>...>v.....>>.>v.>>...v.>.>>.v>.>
....v>v..>>>.v....>..>.>.v.>..>vvv..>.>..>.v>vv.v.v.>v>..>>>...v...v.>..>v.>vvv.>>.v>..>...>>v.>vvv>....>v>.>>vv.v>>......>v.vv.>v>.v>v..v>
v..>v.v...>..>.......v..>>>..>>.>.v.v.v.>v.>.>>>v.>>>>.vv>.......>.>.>>>.......v.>v....v..v...>.>.v>v..>.>>>v..vv>...v.>>...v...>.>>....>..
>>.v....>...v.>..vv.>>>..vv.v..>>..v..v>vv>..>>.vvv..>.v...v...>...>v>.v..v>...>......v.v>....v...v.v..>>>....v>.v>.v>>>...vv>..vv..v...vvv
v..>.v..v....v>.>>>v..v>...v>>v...vv.>>>.>.v>vvvv>.......v>v.>>..>>.vv...v..>>..>..>....>..v.>>v>.v>...v.>v...>v>vvvv>..>v..>>.>.>.>.>>.v..
.vv.v>>>>.>>v.>..>v>..v..>.....v>v.>.>vv.>..v......v>.vvvv.>..v.v.v>>>>..>...>.>.vvv....vv.>>.>...>.....v>>.>....>.v..v....>v..>v.vv.v..v..
..v.>v>>>v.v....v.>.>>vv.>>>v>>>v.vv..v..>>v>v.v>>>>.vv..>>...>v.>v..v..v.v...v>...>>.>.v>...v.>v>v.>v>..v>>vv.v.v.>vv..>.>>....v.>v...>v.v
.>..>>...>v.>v>>.>>>.v.>>v>v.v....v.....>vv.v...>.v>v>vvv>>.v...>>>>vvv...>..v.>.vvv.vv>v>>>>>.>v..>>....>>v>v.>...v>..v....v.>v.>.v.v>>vvv
...>v>.......v.>v>........v>....v.>.vv...v.>>.>>..>...v.....vvv>>.....>...>.>vvv>vvv>..>>..>v...v.v.......>>v>>v....v.>.>v.vv..>.>>..>v..>>
........>>.v>..>.....>.>.>...>>..v......v.v.v.v.>.>v..vv..>.>.v.>v>>..>v.>..vv...v>.>.v..>..v>..v>>vv.v.v.vv...>..v>...vv...v...>>>vv>....>
..vv.>v..vv.....>>.>..>.>v.v>>....>v...vv>>v.>v.v..>.v>..vv.>..v>>>.....vv.>>..v.>.v.v..>...>..>v....v>.>>..>>vv>>..v>.>v.>v.>.>vv...>.>>.>
...vv...vv...>..>...vvv.vv>v.v..v.v.>.>....>.>.v>>..vv..>...>v.v>.>.vv>v>..v....v.>..v.>v..v..v>.vvv.>>>..v>>..vv.v.>.>.v..>.>.>>v.v..>vv>>
>>.>.v.v......v>..v...>vvv.v.v..vvvv>v>>vvv.v.>.......>.>.v.>....>.v.vv.v.v.v.....v>v.>...>.v....vv>.>...v......v..v>v>.>>vv...vv>..v.v....
.>vv>...>>...v.vv...>..>.v.vv..>>.v..>....>.>.vv...v..>>v..>.>>..>v>.>.>>....vv.vvv>.>....>...vv...v.>..>.>>>>v..>..>v>.>vvv..v...>.v>>..>.
v.vv..v...vvvv>>>...>>>.v>.>..vv.v...>.v..>.vv.vv.>....v>v.vvv.vv..v>>>..v..v....>...vvvv.....vv..>..>vvvvvvv.v..>..>v>..>........vv...vvvv
>>.v.>>..>..>.>.>..v>>..>>v.>v..v.v>.v...>v...v.v....>>...>>..v.v.v.v>.>>..>>v..v..>..vv>...>.>>vv>.v..v.v>>..v.v..>v...v..v.>.v....v.vvv>v
v>>.>>>v.>..v>..>vv>>...>..>>>.v>>.v.vv.>.v>..v..>>..vv..v.>..>vvv>>.>..v.>>....>vv>.>v.v.v.>..v.v..>v>>v>>v..v.>..>>...vvv>>...>.vvv.>.v..
...v....>v>..vvv...v..v>..v..>>>>.vv..>v..v.>>.v..>...>>..>.v.>.....v.v.>.>v.v..v.>>........v.v.>v>>vv.vv....>v>>.v>v..>..v.>.>.>>...>.>...
v..>...v>>......v>.vvv...>>.>..vvvv>v....>..>..v>>.>>v>.>.v.v.v.v..>...v>...v..>vvv>>..vv.....v>.>.v.>.v>>.....>..v>v.>..vvvvv....v....v.v.
.>v>vv.v>.....>.vv>.....vvvv.>...v.v>...v.>.v...>.>vv..>v..>.>v.vv.vv>.vv...v...vvv..v.>v>v>.>v.>.>>..>>>.>v>>v>.>.v.>...>...v>>>>v....>..>
>.vvv...>..>.>>>>>..v....v.>>....>..vv>.>.v.v.>..v..>..............v.>>v...vvv...v..>..v.v.>v>v.>>>....v.>..v>>>..vv.>v..v>.>..>.>>v..v...v
>v>>...v...v>..v.v..>v.vv.v.>.>.v....v.v...>.v.>..>vvvvv>v>vv..vv....vv..v>>>.v.v.v.>.>.v..vv>v.>>..v.>vvv..>.v..v>>...v..vvv>.>v>vv>..>>vv
.v..v.>.>v....>.v...v...>.v>...v>>...vv..v>v.v.vv.>..>.>v..v...v>..>>v..v.v.>v>...>.v.v>..>>.>.>vv.v>>..>>>..>..v.>.>>>vvvvv>......>.>...>>
.>v>...>>...>.>...>.v..>>.v..>>.v....>v.v>..v>..>....>..>v>>.vv>.v.vvv.v.....v..vvv.>>.v>>>v>v>>v>.>v.>>v>..>.>>>>>v..vv..>......>>.>>.>>>.
.v...v>>....v.v>>vv>.v....vv..vv>vvvv..v...>v>vv.v....>v>..>>v..>.v.>.>v.v.vv>v.>>.>.>.>v>..>v.>...vv..v>v.v.>v...v.vv>v>.....>..v..v>v.>..
.v.>...vv.v.>v>.>...vv>..v>..v>>v>>v.v>v..>....v.>.vv.>>vvvv..v.>..>v>v.vv..>>...>...>.>>>..vvv.....v..>.......v.>vv....v..v..>.>.v>.>v..>.
v..v...>v...v..>v.v.v>>.>v>vv>>.>v.vv.v>...v>.>...v>>.v>..v.>..>.v>>.>.....>.>vv>>.vv>..>>>>.>>v..v>...>..v.v.v>>v>vv.vv>..v>>>>>>v...>.v..
...>...>>.vvv.....vv..>>..v..>....>vv...>vv>>>>.v.>>.>..v>v.vv.....v>..>.>>v>v>>>..vv.....vv..v>..vv>>...>.>.v...v..v>.v....>>..v....v.....
.....>>v.>>.>.>..v..>.>....v.vv.>v..vv..>v..vv.v.>v.v>..>>vv>>..v>>>.>........v.>.v.>...v>.>..>>v..v.>>v..vv.>>....v.>.v.v>..>>.>.vv.>vvv..
...v..>v..>>.>>.>>..v.>.>vv.>.v>.>v..>vv>..v>v..>v>vv...v...v>>>vv>>.>>..>v.>..>v>>>..>v>...>>v>.v.>v>...>>..vv..vvvv..v>>v..v..vvvv.v>....
..v.>.>..v.>>..v..>v>.v.v.>v..>v.v..........v.v>>v>..>>>....>>..v..>vv>....>..>.v.v.......v>v>v.v>>>v.v.>>.vv..>..>v..vvv..>>v..>..v.>v.>..
.v>>...>>>vvv..>v...v......vv.vv>v.v....>.v..>vv.>>.vv...v.>.>>..v>..vv.>>........v.>.>vv.....v>.>v.vv.v>......>>..>.vv>>.>v>.v......>....v
.>>>v........>.v.>.>...v.>..vv>.v..>v.>>v....>v..vv.vv..v>vvv>..v....>.>..v.>......>.....v.>.v.v..v..v>.>v.>.>.>>...>..>>.vv..>>>.vv..v>>.v
>>>>...v...v.v.......v....>..>.>..>.v.>...v>.>v..>.v>.>......v>>>.>.>v....>.>..vv..v.>v>>>..>..>v.v.>.v.>>.v..>..>>v...>>v>.v>.>.v>v.v>....
v.vv....>v.v.v..v.v..v.....>>v.>.v..>.........v..>....v..>v.v>.v>..v>....>>v>.v...>>>v...>>.>...v...vv>v....v.v.>.>v.>>..vv.v>..vvvv>...v..
.vvv...>>>v..>>..>..>v>..>.>...>vv>>>.>...vv.v..v.....>v.>.>v>..v....vv>.>.v..vv.>.>v.>>.vv.>.vvv>.>vv..>>....v...>.>v.>>.>.v..>v>.vv.v.v>.
v>>..vv>vv..>.v>>..v.v>..>v..v>.v>vvv>..v.>>v>..v.>.>..v>>.vv>>..v..>vvv>..>vv.>...>...>>v........vv.v.v..>.>>.>>.v.>.>....>...>.vv.>.vv.>.
..v>v>>v..>.vv.v.vv..>..v>.>v..>v>.>vv.>..>.>.v>.>>v>.v.v.>.vv.>>v...>>vv...vv.>.>>.>..>.v>vv..>..v.>v..v.vvv>.v...>.v.v.>>v>>..>.v>..v..>>
>>vv......v.>v.v>.....>....vv.v>..>.vv>v>>v..v>...v.>......v..v.>..v>..>vvvv..v.vv.v>.v>v..v...v..v..>v..v..>.>vv>..v...v...>vv...vv...v...
...v>>.v>..>....>>>>>vvv.v>.>>vv..>.>.v>v.....>..>..v>vv..v..v>..v.>>>v>v>v...>.>...>...>>.......v.v.v....>>v..v.vvv.vv>>...>v>>.v....v.v..
v>vvv>.>...>..>>.v..>.>>v.vvvvv....>.v>.>>>..v.v....>.v>...>>v.v>..v...v>..........>..>..>v..vv.>.>vv>>..>>..v...v.v>>vv>v>..>v..vv..>v.v..
.vv>>>>>v>.>vv>.v.>>.>>>.>>>>v..>v.>>.v>..v>.>>vv..v.....>...vv...>>..>v.v>.>v>vv>..vv..>.v.>v>>.>...>vv>..v>v..>.>v.vvv..>...v.>v.>.vv....
v>vv.vvv>.v.v.v>....>.>v>>..vv>>.>>.>v..v..>>>...>..>v...>..>.vvvv..>>.v>.>>.>..vv.....>.>..v.vv>.>>v...v>..v.vv..v>v>.>....v>v.>>.>vv.>>v.
.>.>.v.v.v..>.>.>v>v>.>...>.>.v>v>.v>.v>>..>.v.>..vv>......>.>>..vv.>v.v>v..vv>...vv.>v>>..>v..>>vv.>>...>.....v..>>..v.>vv...>.>.>..>..v..
.>>...v..v>....v....vvv.>v..v.....>.>.>vv>v.v..>.....vv>>.vvvv....v..>>..vvvv.>vv..vv>vvvv.>..v.>..>>.vv.v..vv>>...v>v.>v>v...v.v>v.>>v>v..
>>>.v>.v....v>.v.>.v......vv.v...>..v.vvv..>..vvv.vv..>v.>v>v.>..v.v>v.v>>.>..v.........>>..v..vvvvv..v....v.......>.>..vv.v.v.vvv.....>>vv
>v>.v..>.v>.v...>v.>>.>v..>.v>.....>.>>..v>....>.>v.v.>.v>..vv>v....>.>v...>.>..>>.v.>.....v.v...v...>.>.........>..>...>.>..v...>v......>>
.>>..>>.>...v.>..v.v...v.v>vv.>>.>v>>>.vv...>.....>.v.v..v>..v..>..>.v>>v>..>.vvvv>..vv>....>...>...>.....v...v>>.vv...vv>..>>..>>.>v.>>v.v
>v>v>vv..>..>>.v....v...>>v>.....vv>.>.vv.v>v.>.>>v>>.vvvv..v....>.>.v>....>.v>.vv..v>>..>v>>.v>v.>..>.v.v>...vv...>vv.>..v...>vv>v.v>.v.v.
.vv>v.>v.......>.>......vvv.>.>v..v.>v>>>.>..vvvvv>....vvvv>v..v>v..>v>>>>v.>vv>vvvv..v....>...>...vv..v>.vv...>>v>vvvvv...>v>>.vv>.>v.>...
...>..>.>>...>..>.v.>vvv.v.v>>....v>..>....v>>.>vv..>...>...v.>.>.......>v.v....>.vvv.>...v.v.>.v..>...v.v.vv....v>...>vvv>...>>.vv....>..>
vv..v....v..>..v..v.>.>v.>v>.>.>..>.v..v.>vv>>.v..v..v..v.v>>>v..>..>......v>.v...>...>.v>>vv.>...>.v..v..v..v..v.>.v...>>..>>.>.v>..v..v..
v..v.....>v...>.v>v.v..v.>.....>..>..v.>v....>.v.......>..>v>.>......>>..vv>>..vvv..>v.vv.>v...>....>.>.v..>....>....v.>.>>vv..>.v..>>v.>>.
..>>vv.vv>>....v>v.v.v>v>..v>...>.v>..>.v>v.>.v.>>.v>>>vvv.v>.v...v..v.vv.>.v>.v.vv>...>.v.vvv.v.>>v.>.>>..>.....v.>v.v>vvv>>v>.v.>.>vv.>>>
>.v>.v..v>...>..>..v.>...v>v.>.v.>....v.>v..>>..vv....vvvvv..>.vv.v>vv..>v.>v>.>>v....>v>......v..>v.v>.v....vv.vv>>vv.>vvv..v>v..>>v.>vvv.
...>..>....v....>v.v>.>>v.>v>..vvvv>...v..v....vv...v.>>.......>v>>v...vv.....>>vvv>v>>>..>vv>.v>v.>vvvvvv..v....vvv>>>v>vvv>.>........v..>
....v.>>.vvvv>.>>v.>>.>..v>...>.>.>v>..vv>>..>....vvv>v>>v..>v.vv..>vvv>v.v....vv.>.v>.v>..>v.>.>..v...vv>.>v>.v>..v.v>vv...>.>...>>.....>>
>>v.>..vvv.vv.v>v..v>vvv.>..>.v..>>.vv>>.v...>...>>>>>.v...v........vv..>v.v.>v>..v..>.>>.v>>.>>>..>>v.v.v......>.v.v.>v..v>v>.v...........
..>.>.v..>.vv..>>.>.>vvv...>v.vv>.>..v..v..>.>.>.vvv........v.>>>.>.vv>v>>v..>>v..>>>.vv>.vvv>>v.>>..v.>v...v>..>..>.v..v..>.vv...v...>.>.v
.vvv..v>.>..v.>..>v....v>>>>.>.>.>v>..vv.>.>....v>....>....>>v...vv.v>vv.>.>.....v>vvv..vvvv>....>>.>..v.>....v.>>v>...v.v.>>>.v>>.>.v>>.>.
.>.>v.>.v..vvv....>....vv>>.v.v....v.>.v>..>....vv.v.vv...>v....>.......>.>.v....v..>>vv>.>>v>..>vv.v...vv.>.>v>.vv...>vv.v>..>..vv>.>.v...
>v.>>>vv.vv..v.....v..>>>.>.vv>>vv.>.>.v>v>..>v.>....v......vv.>>.vv...v..v>v>...>>>>..vvv...>.......v>vv..>.>>..>>v.>..v..>.v..vv..>.vv.>>
...>>>v>>v.......>.vv.v>>..>..>>.>.v.v>>>..v.>>>v>...v..>.>..vv.v>v.v>.v.>v....>v....v..vv>v>v....>....vv>v>.>v.>.v>>v.....>v>v.v..>....>..
.>>.>..v.>.v>>.>.>>..>>.v.>v.vv>v.>v.>v.v...vv...>.v.v>v......>>.v.v..v>..>>>...vv>vvvv...>v.vvvv.>vv.vv......vvv.....v..>>>v...>v..>.>>.>v
v.vv.vv>vv>v.v...>.>vv>>....>....>.vv>>>v.v..v..vv.v.vv.>vv....v>v.>v>>>>>.>.v.>.>>>>>>.>.>v..v>.v>.v..>...vvv........v>...>.>v>......>>.vv
>v>.......vv.>..>>vv>...>..>.......v>.v...v>vvv>.>.v..>....v.v.....v.>>.v>vvv>>>..>.v>>.>>...>..vv....>v.vv..v>.vv>.>.v..>.......>..>v>...>
....>v>.vv>..>.>v...v....v..v>v>>.v.>v..>vv...v>.>.>.>.v..>.v.v...vv>...>v........>>.v..v>.v.....>...>>.vv>>>>.v>v....>>.>>>.v.v>.>...v.>vv
..vv>v.>vv..v.vv..>.v.v.vv......>>v>.v.v.v>>>....>...v.>>v>vv>...v>>v>.vv.>.vv.v..>.v>>..>..v...v..>.vvv.v....v>v.vv.>.v.>>.>>.>.vvvv.vvvv.
..>..v>.>vv>....v.>>.>>>>v>.>v..vv>..vv>>.>..>.v>>......v.>...v.......v.vv....v>...v.>v>.>>v.vvv.>.....v>v>....v..>..vvv.vv>.>>v>vv..>.>>>v
v.>v.>.>.>.....>.v>v.>>vv>vv>...v>...>v...v.v...>>v.>...>v.>v>.>.v.....>>.>>....>.>v>>.>v.v..>....v..>>v>.>>.>......>.v.v>vv.>.>>>>>>>.v..>
>vvv.>.>>.v.>...vvvv...v>..v>.>....>.>vv...>>..>v>>.>>...v..v..v>..v.v..>v>.>.vv...>..vvv.>v>v.>>.vv>v>v.vv.>v...>.vv>v.>>v.>.v>>..>..v.>vv
>.>.>....v....v.v>.v..>..vv..v>v.v...........>v>....vv..>>..>>v.>vv.v......>.>.>..>>.v.v>.>..v>>v.vvv...vv.....>vv>>.vv>....vv.v>v.....vv>.
>.vv>.>.>....>..v.>v.>..>>..v.v.>v>..>>vv...vv.>v..>.vv..v.v.v....>>>.>>>.v.>>.>>..vv>vv>.>..vvv.v.....v...>.v>..v.v>>..vvv.vv.v.v.....>>v.
.v.>.....v..>>.v...>>v..>>v.....v...v>..v..v..>..>.v.v>.>.>..v.......v..v>...v...>..v>.>>>.v>v>vv..>.>v...v...>>vv.vv....v>v>....>...vv.>.>
>>..v..>.>.>.>>>.>>.........vv...v>.v>v..vv.>..>vv.>vv.......v.>.v..vv....>>>>...v.>vvvvv..vv.....>...>.>vv>..>.>>>vvvv...vv>v.>.>.v.v>>>>v
v...>.>.>.>..vv.>>.vv>v.vv>v..v>>.v.>.>v..v>.....v...>vv>v>v>...v...v>..>.>..v>..>v>v>>>v.v..v..>>>vvv....>.v.......>>..>vvvv.v>.>...>>v.v>
>.>.......v>..v...v...v..v>v.>vv..vvvvvv.v.>....v.vvv.>.>>.>.v>.v..v>.v>.>.vv>>v.vv...>v...v>.vv>.>v>>....v>.vv.>..v..>v>v...vv...v>>v...v>
.v>vv...>.>..>v>.v.v.>>.>>vv...>>.......>..>...v.>v.....v.>....>v>.>.v>>>.>.v>vv..vv....>.>>>.v....>.....>.>>.v.>.>v>v>.>v.v.v.v.>>..v>.v..
>vv.>.....>.v>..v.>...vvv>>>..vv.>v>....v.......>>.....>vv..>>vvv>>..v>v.>v...>..>....vv>.v>..v>>v..>.vv>>...>v>..>v>....v...>..v.........v
v....>.>>.>>>>>>..>vvvv.vvv.>v...vv>v...>v..>>..>>..v>>v>.>vv....>>>.>v.>..vv.v>..vvv.v.....v..v>....>>v...v...>vv.v....>..>..v.v.>.>.v>.vv
v>vv>..v.>v...v>.>v..>>>..>..>.>v..v....vvvv......>.v....>.>.v.v>>vv.vvv...v..>v.>.v...v.v>..>..v>v>>..v..>>.v..v>>.v.>.vv..vvv.>>..>vv....
.v..>.>v......>...>>..>.>.>v>.>..vv...vv.>.>v.v....v.vvv.v.>vv>>.v.v..v.>.>>v...>v.>..vv..v.....v>...>v..vv...v..v.v..>v.v.>.>....v.v.>....
..v.>.vv>v>.v..v>....>>>.v>>>>.v...v>>v..vvvv>..v>v>.v..>.vv...v..v.v>v.>vv.vv..vv>.v>v..vv>v..>>.v......vv>.>>>.>>.vv.v.....>v>v.v..>.v.>.
>v.....v.>v...v>.v>.>.>...v.vv>.>>.vv.>>...v.v.v.>..v>>v...vvv.v>.....v>v.v.>>.vv.>>v.v>.>.>.vv>..v.>>.>....vv>..>v..>.v....>v>vv>>v..v..>.
v..>v>>..v.vvv>.>>>.v..>.v..v..v.v....v....vvv.v....vv>...>>>..v>........v.v...>.>>..vv.>..vv..>v..v..v...vvv.>v>v.>v>....>v>>>..>>....>...
vv>.>vv..vv..>v.>.>...>v.>>.v..>..vv.v.v.>.>v>..vv..vv...>.v.v...v....>v.>.>>v.>v.v.v.>>.>v.>.v>.....v>vvv>>.vv...>>>>.v...vvv.v>>.v>vv..vv
...>...v.vv....>>>v>.vv.v.....>.v>v.>.v>.v.v.v.v...>v....v>.vv.>..vvv.v........>>>..v........>.....v>v..v.v..v>>v.>>>>..v..vv.>......v>..v.
...v....v.v>.>.>..v..v..v>.vv..>....>.vv..v>v...>.v....v.v.......vv..vv.>>..v.vv>>.>vv...v....>.v>>v>.>vv..v>v..>..v>>.>>..>..>>.vvv.v...v>
.>v..>.>..v.....>>..v>v..v>.>v.>>v.v..>..>>.>v.v..vv..v.....v...>.>..vvv..>>......v.v>>...>>v>v..v..v....v>>.vv>.v>v>vv...>.........>.vv>..
v>v.v..vvv..>...v....v..>>...>>...>...v.>vv..>.>..v>.vv..>....v..vv.>>v.....v.>>.....v..>.>.v>...>v.....v>..v.>>v.v>v..v...>..v>>.>v.>...v.
.v>>.v....v>.v>>>.>..>....v>>>.v...>.>>.>>..v.....v>>....v.>>vvv...>>>....vv.vvvv...>.v..>vvvvv>..v.vv.>.>.>v.>>v.>.vvvv.>>v..>>v....v>>>v.
v.v>...>v..v>.>vv...v..>>>>v>.>v..v.>..........>>...v...>...vv...v>.vvvv>.v>.v.>vv...>..>>v..>.v.vv...>...>.>v>>>.v>..>......>.v..>.......>
....>v...v.....>..>...>v>>.>...>.>.vv..v.v>.....>>..v.>v.v>...>>>v>>.v>v..>.v>>>.v..vv..>.>.v...vv..v..vv.>v..>.vv.>v.>v.v>vv..v...>.>....>
.>.>.>.>..v>v.>.....v>.v..>vv...v>..vv>..vvv...v..vvv.........vv>vv...v.>.v...>.>.v>.vv.v.>...>>..v.>v>..v..>>..>...>..>.>....vv>.v.>..>...
>v>.....>v.>.v.>>.....>>>.vvv.....>..>>.v>v>..v...>>.>v.v..>>v..>vvv.v......vvvv>>>..v>.>vv.>.v>.v>..>......>...v>>.>.v...v>.>>.v.vv..v>...
...v.v.v.>.>v>..>.>..v>vv>..v..v>..v>....v>.vv.v>.vv>>>.v......>.....>v.v.....>.>..>v.>v.vvv>>>>>.>>.vv>v...>v.....vv>>.>>>>>>v....vv.v...v
>>v>vv.>..v.v.>vv>>v....v..v>.v.vv.v.v....>>vv...v..v>vv.>.v...>>vvv.v.>v>....v...v.v....v.>..v.>>>v.v>>>......>>...v>..>>.v.>..v..>v>>.vv>
v...vv>>...>.>>vv.....>...>>>v.>>v>.>>>v.vvv......vvvv..v.vv..>>vv..vvv......v.>.vv..>>.v.v>.v...>v.>v.>.>.>.>>v.vvv.vv.>..v.>..>v....>v>.v
>.v>>....vv..>......vv.v..>...v>..vv>vvv>..vvv.>...v.v...>.....v>.>>..>..>>v.v..v..v.>v.>.>>.v>vvvv>v.....v.....v>>v..>.>v.....>>.>...vv.>>
.>..v..v>...v.v>>..>.v.....>>...>.v>vvvvv..>>..>..v>...>..>>>>>.v.>..>>v.v.v..>v....v....>>v..>>.v.....>v>.>.vv.vv.v>..vvv>.v.v.>..>>>v>..v
>>v>>vv.....v>.>..>v...........>>>v>.v.....v.v.>v.vv..v>v.v.>>>>vv>....>v>>v.>.v.v.v...>>..vvv..>vv.v.>vv>..vv.>v...v>.v>>v>.>.vv>.v...>vv.
.vv.....>...>v>..v.>vv...>v....>..v.>v.vv>>>.vvv.>.v>.>.>.....>..v.v..v..vv..vvv>......>v.>.>vv...v.>vv>.>....v..>v.>..v.>.v>.v.>....>....v
...v.>>>>.v..>v>...v..v>...v.>>vv>....v.vv..vv.vv>v.>>.vv>>>.v>.v...v...v.....>.>..>v>.v..>v>...v.v.>.v.v>.v..v.vvv>v>.....v>.>.v>..v.>v..v
..>.>.........v>.v..>>v..>..v....vv.v>....vv..vv.v.vv>.v>>>.v>vv.>......vvv...>>v>>.vv..vv>.......v..vv>.vv>>.v..vv>.>>..v.vv..v.v..>v.>..>
..>>.v.v...v..>..v.>v.......v..v>.>......v..v.v....>...v..>..>.v>.....>v...v.v>.>..v.v.>..>vv.v.v..>v..vv>v........v>..>v.vvv>>.....>.>>>.>
vv>.....v.>vv>>>>>....v>vv.>.......>..>.v..v..>vvv..v.>.v.vvvv..v..>v....>..v>..v..v.....v>v...>.vv>.vv.vvv.>.v>..vvv>v>>.v...>>v..v.......
v.v>.>...v>.v.>...>..>....>v...>v>.>.>..>..>>....>v..v..>...v....>>v.>v.>v.vv>.vvv>>..v>>>>>.vv.v>.>....>......>vv>.v.vv.>>.v.>.>.>..>>v>>v
v>>v.vv>.....>...>.v......vv..>..v.vv.>.>..v>...vv........vv...v>..>.v..v.vv>....v.>..v..>>v....v>>.v>v.vv.v.vv>.v>>.>>>>..>vvvvv.v....>>..
..v>.>v..vvv.v>..v>v.v.v..vv>v.>....v.>......>...>v>vvv.v>vv.>>.>.>>.>.....v.v.....v.vv.>......>vv.v..v..v....>v>v...v.v.>.>......>.>vv.v.v
>>......v.>.>.v..v..>>v..v>>v.>...v..>v.v...v>>..v..>>..v.vv.>>v>.vv.v.v...>>.>...>.v....>>.v.v.>...vv....vvv>....>.>.v.v...>v>.vv..vv.v.v.
.vvv.>>>.>...v.v>>.vv>v.>...>>v.v.v...v.>>.>v....>.>..>...>...>>....>v.>.>.>...v.>v..>.>..>v..v..>>..>>v>......>.>..>..v..>.v......>.>v..>>
v>..>>..>.>..v.v..>.v..>>v.vv...>...>.>.v..v.....v.>v..>..v.......v.>..>...vv....v..>v.>vv.>v.>.>v>.....v.>......v>.vvv....v.v.v.......>>.>
..v.vv>v..>v.vv>.>>>..v>vv....v>.......v..v.....>.v.>>.>>..>.v.>..v.vv....vvv...>.v>vvvv....v.v..v.v>..>>>>>vvv>v.>vv>..>.vvv.>.>..v.vv.>>>
...vv>>.vv>v.v>>...>...v..v>>..vvvv..v>>v...>.>>v>..v......v.v...>>...vv>>v..v.v>......v..v...vv.v>....v.>vv..>v.v..v>.>...>vv....v.>...v..
vvv....v>>v..v>vv>>v..>.....>.>v>.vv..v..vvv.>.vvv.v.v.>.....vvv>.v>>.>v>v..>..>.vv..v...v>v>...v.>>>.....>v.v>v..v....>....v.>>>.vvv>>.v..
..vv.>.vvv.v.v.>.vvvv>>>.....>.>v.v>..v.>vv.>.>....>v.>v>.vv>..v..v.>....v>..v.v>>vv>.v.v..v>..v.v.>v>v...v...v.>v>vv..v.v.....>.v>>>v.>>.>
>.>.>...>.>v>.vv.>....v.vv.v>.>.>vv.>...v.>>.vvv.>.v.v..v..>.vv>>.>v.....v..vv.......v.>.>.>..v>>>.v.v..>>...v.v...>.>v.v..>.vv.v.v..>>v>vv
vvv>.vv.......>v....v>..v.v.v.>...>..vv.>.>..v>v>>>vv.v.v>v.>v.>v>vv...v.v>v.>vvv.>>.>vv.vv..vv.>..v.>.>v...>.>v>>>..v>v.>>>.>>v.>>>.>v>vv>
>.vv>..>v..v.v..>v>.v....>>...>.v.v>..>...v...>v>.>...v..>..>v....v.v..>>.vv...v.v>..>>..>..>..>v...v..v.>v.>>>..v.v.>...v....v.>.>..>v>...
..v..>....v.>..>.>v.>>>.v....vvv>..>>v.vv.>v.>v..v..v.>v...>.>..>.vv>>..>v>.v>v>..v...>...v>.v..>..>>>v.....>vv..v...>v...>.>v>....v...vv>>
v>v..vv..>v>>.....>...v.v.>v>.>vv..vv>v.>.>..vv.>>>v>.v>..>v..vv.v.>..>.>>vv>vv.v>....vv......>v.......v>v...>v.v>..>vv..v..>...>.v...v....
vv..>>..v>..>v.vv.>...>.>v.>>vv>v>.>..v.v.v>...v....v>....>>vv>>v>>.....>.>v...>v..v>.vv.vv.>.>v.v>>vvv>...v>>v>.vv..>>>v..>.v..v..v..vv.vv
.>..>.>.>>.>.>.v..v.>...v.>....vvvv..vv..v>>>v.v........>vv>......>v..v..>..v.....v>.>vv..v.>.v.v>>....v..>>v>.>...vv.>...>vv..>....v..>..>
v.vv.v>>v..v>..>>>v>..v>.vvv>>v...>.>.v...>....>v..>.v..>.>>v>>>.v..>>.v>>.>>>..vv>..>...v..>vv.>vv.>v>vv>.vv..>>.vv...>......>...v.>v>>>..
.>.............>>v>.v.>>>v.....v......vv>>.....>..vv.>>>v>>vv.v..v>>>>>..v...>..v..v>v.>>...vv.>>..v>..>.>v..>......>....>.>>v>v......v>.v>
.>.vv.>.....>.vvv...>.v...>.>vvv>.v....>.>.>..vvv......>..v>vv.v>.v....>>v>vvv.....>>..>.....>>.>..>vv>.>>vv....vv.....v.v.>..>v....>vvvvv.
>>.v..>>v.v>..>.v>.v>vv.v..v>vv.>.>...>v.>.v....vvv.v.vv.v....>>>..v.....v.v>>v.vv.v.v>v.>>>.>>...v....>..v.v..v..v...>>>v>>.vv.>...>.v..>.
v>...>vvvv>>.v...vv.vvv>>>>.v......v..>.>...v....v.>....vv>..vv.>.v.vv.v.>...vv.>.v>.....v.>>>.v.>v...vvv>.v...v>.....>>.v...........v.>.>.
....v.vv..>...v...>v...>...>..>.v.>v.>.v......vv..>v.>>.>>.>v>.v..v...v....v...>..>v.>..vv..>.>...v>>>...vvvvv..>.v..vv.>..v.>>..>v..>..v>>
..>>>...>v.>>.........>>..v..>v.vvvv.>>>.......v>....>>>...v.>v>...v>...>...v>..>v.v>vvv..>..>>...>.........v>..>v>.v.>.v>.>v.v.>v.>..>>v>v
.v>>..v...>v>..>.>.>vv.>.v.>v.v.>>..>>.>v>.>.v>..v..vv>..v>v..>>>>v.vv>..>v>>...>.v.>....>vv.>>>......v.>v.>>....>vv.vvv...v>.>>v.v>..v..v.
.>..>.vvv..>.v..>.v.vv......>..vvvv..v..>>.>vvvvvv>>..>.v>>.v>.....>vv.>>>...v..vv.v..>..v....>.>.vv.v.v>.v..>.>>.v.>vv.v>.v>..v>.....>...v
>..v..>v...v.>>.vv.v>.v.>..>>>v>.vvv>>>...>.>..>v..>>..>>>>v..v.vv.v>.>.>...>........vv>.v.v>>.>v.v>.v.v......>vv>.v.vv..>>v..>>v..v..>>v.>
...>vvvv.v...>>v.v....>..v>>.v.v..vv.vv.v.v>..v..v.v...>......>vv.......v>vv>..>v..v>>>..>v..>>>....>v...vvv.....vv..>.>.......v>...>>..>>.
.......>.>>>.........v>>v.>>...>..>..v.v.>..v...>..>.vv.>.>...vv>...>.....>..>.v.v>..>.>.....>vv.>.>v.>>.>..>>.>>v..>>>.v..v>v....>...v.>.>
v.>...>...v.>..>v.vv.v.>..>>..>..v....v>.v..>.>>.>.>..v..vvv.>v..>.>v>.v.v.>....vvv...>.>.v..v..>.....>>.....>..>.v.v.>..v.vv>.>v.v.v...>>.`
